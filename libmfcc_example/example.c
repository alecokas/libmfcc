/*
 * example.c - example of using libMFCC with pre-computed filterbank parameters
 * Written 2017 - A. Kastanos based on the example provided by J. Sawruk
 */

#include <stdio.h>
#include <string.h>

#include "libmfcc.h"

int main(void)
{
	// Spectrum was computed in Octave Fs = 22050 Hz, 256-point single-sided FFT
	// Data was not windowed (rectangular)

	// Determine which MFCC coefficient to compute
	unsigned int coeff;

	// Holds the value of the computed coefficient
	float mfcc_result;

	// Initialise the spectrum data to be analyzed
	float spectrum[256] = {0.013591,1,0.92,0.23959,0.17239,0.30009,0.51487,0.23649,0.054565,0.095899,0.11554,0.1138,0.29077,0.17722,0.12896,0.13281,0.027977,0.056025,0.027453,0.040295,0.065038,0.017914,0.047739,0.054485,0.054493,0.034712,0.034928,0.032303,0.031389,0.10839,0.1539,0.10708,0.024312,0.057683,0.054191,0.0068596,0.023372,0.030475,0.030118,0.013303,0.038049,0.0050173,0.025941,0.004056,0.025858,0.020179,0.0077463,0.014441,0.020758,0.0060369,0.01625,0.011679,0.025482,0.0059594,0.030398,0.010221,0.018075,0.005906,0.017527,0.0057519,0.017383,0.0051743,0.014803,0.006165,0.012492,0.012376,0.016059,0.004879,0.008864,0.0079047,0.014834,0.011069,0.024919,0.0072086,0.015548,0.0044955,0.0119,0.0099431,0.020952,0.0050955,0.014902,0.0048688,0.015144,0.014841,0.0069139,0.0049244,0.010001,0.0046291,0.012039,0.0076951,0.016341,0.0040873,0.0098866,0.0048084,0.0079235,0.0035336,0.0087897,0.0021192,0.0093232,0.0014006,0.0084748,0.0055236,0.013099,0.0046125,0.0057938,0.0022634,0.0069971,0.0043067,0.011926,0.00079653,0.0093633,0.0016716,0.0081201,0.0032168,0.0052659,0.0026742,0.0068036,0.0012178,0.0030844,0.0081704,0.012073,0.003866,0.01097,0.0039033,0.0055145,0.0031606,0.0042412,0.011448,0.017405,0.00070763,0.014749,0.0051914,0.0068868,0.0040451,0.0083694,0.0016368,0.0083952,0.0027609,0.0089196,0.005933,0.01755,0.0096739,0.0092543,0.0053582,0.0035568,0.0027728,0.0069102,0.00075842,0.0074947,0.0023995,0.0065859,0.010943,0.014599,0.0065543,0.0063651,0.0016246,0.006157,0.0014633,0.0064017,0.0023411,0.01167,0.0071046,0.0036927,0.0084421,0.010308,0.0051339,0.0017883,0.0045758,0.0058261,0.003276,0.006599,0.0019872,0.0058264,0.0048028,0.0073237,0.0025069,0.0055994,0.0055489,0.010389,0.0036858,0.0097879,0.0012996,0.0057353,0.0040814,0.010509,0.0022586,0.0053841,0.0012747,0.0054922,0.0044542,0.011308,0.0030233,0.0059139,0.00072924,0.0030504,0.0057271,0.0098672,0.0030424,0.011271,0.0049698,0.0070374,0.00091074,0.0068634,0.001235,0.0072366,0.0035775,0.0050704,0.0025947,0.0057244,0.0025577,0.0075726,0.001728,0.005071,0.0038458,0.0093626,0.00094522,0.0060687,0.002956,0.0096635,0.0017617,0.0051083,0.0023215,0.0087043,0.0021942,0.0048625,0.0035468,0.010057,0.0033798,0.0068668,0.0026728,0.0072389,0.0038641,0.010125,0.0030719,0.0037204,0.0066119,0.011874,0.0021355,0.0071996,0.0026434,0.0082935,0.0008327,0.0082435,0.0036024,0.0065615,0.0014853,0.0065401,0.0029168,0.009816,0.0045245,0.0037637,0.0034399,0.0076322,0.0017681,0.008687,0.0048908};

	// Holds the filter parameter array
	float filtParams[48*255];
	memset(&filtParams, 0, sizeof(filtParams));

	// Compute filterbank parameters
	populateMFCCFilterParams(filtParams, 44100, 256, 48);

	// Compute the first 13 coefficients
	for(coeff = 0; coeff < 13; coeff++)
	{
		mfcc_result = getMFCC(spectrum, filtParams, 44100, 48, 256, coeff);
		printf("%i %f\n", coeff, mfcc_result);
	}
	getchar();
	
	return 0;
}